from   qet.parser        import proj_dos_out
import matplotlib.pyplot as     plt

def plot_proj_dos(filename="./proj_dos.out"):
    
    # Parse the projected density of states
    out = proj_dos_out(filename)

    # Loop over atoms/wavefunctions
    for atom_num in sorted(out["PDOS energies"]):
        for wfn_num in sorted(out["PDOS energies"][atom_num]):

            # Get energies, projected dos, atom name 
            # and wavefunction name
            es = out["PDOS energies"][atom_num][wfn_num]
            ps = out["PDOS (energy)"][atom_num][wfn_num]
            an = out["PDOS atom names"][atom_num][wfn_num]
            wf = out["PDOS wfc names"][atom_num][wfn_num]

            # Plot this projected DOS
            label = "Atom {0} ({1}) wfn {2} ({3})"
            label = label.format(atom_num, an, wfn_num, wf)
            plt.plot(es,ps,label=label)

    # Show the plot
    plt.legend()
    plt.show()
